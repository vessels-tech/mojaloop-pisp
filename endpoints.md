# Endpoints

---
Authors: Lewis Daly
Solution Proposal Status: Draft
Created: 01-April-2020
Last Updated: 01-April-2020
Approved/Rejected Date: N/A
---

The purpose of this document is to outline the new and modified endpoints and interfaces for implementing the PISP functionality within Mojaloop.

> ***Note:** This is really a first pass at the endpoints and interfaces list. It aims to capture what we've talked about already

## Assumptions

- Async everything
- FIDO, but no OAuth2
- Quote and Auth callbacks are combined
- No balance checks, but get the balance of the given account in the Quote+Auth response
- Scope:
  - Interface between the PISP App and PISP Server is not covered here. 

## Interface Summary:

A list of the new calls and endpoints that need to be supported

### PISP-Server

#### Outbound
- `GET /loginUri/<ID>`
- `GET /parties/<Type>/<ID>` (modified to include the linking token)
> Note: random id generated by the PISP to identify the challenge in future steps
- `GET /auth/challenge/<ID>` 
- `PUT /auth/challenge/<ID>`

#### Inbound
- `PUT /loginUri/<ID>`
- `PUT /loginUri/error/<ID>`
- `POST /parties/<Type>/<ID>` (modified to understand the `accountList`)
> This can be used both to recieve the challenge and the challenge result
- `PUT /auth/challenge/<ID>`
- `PUT /auth/challenge/error/<ID>`
> Note, this somehow needs to know about the previous challenge so it can tie the public key and account association together
> We could also wrap up the association step with the `PUT /auth/challenge` callback
- `PUT /auth/association/<ID>`

### Switch

### FIDO

### DFSP


## Linking

1. GET loginUrl
- PISP -> Switch


## Discovery

## Agreement (quoting)

## Transfer


## Questions:

- how does the PISP Get the login uri of the DFSP? Should this be stored in the ALS and looked up by the switch? Or should the switch redirect the request to the DSFP?


- who should initiate the association steps?
- Maybe we need a callback from the switch to the DFSP to say: "A new FIDO has been registered for an account you own"


- How about revokation from both PISP and DFSP ends?